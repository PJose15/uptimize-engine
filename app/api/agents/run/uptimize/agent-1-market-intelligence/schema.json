{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "UptimizeAI_Agent1_Targeting_v2",
  "type": "object",
  "required": [
    "run_metadata",
    "angle_of_the_day",
    "do_not_target",
    "target_pack_primary",
    "target_pack_secondary",
    "shadow_ops_insights"
  ],
  "properties": {
    "run_metadata": {
      "type": "object",
      "required": ["run_date", "segment_focus", "sources_used", "notes"],
      "properties": {
        "run_date": { "type": "string", "description": "ISO date" },
        "segment_focus": { "type": "string" },
        "sources_used": { "type": "array", "items": { "type": "string" } },
        "notes": { "type": "string" }
      }
    },
    "angle_of_the_day": {
      "type": "object",
      "required": ["primary_angle", "secondary_angle", "pattern_interrupt_question"],
      "properties": {
        "primary_angle": { "type": "string" },
        "secondary_angle": { "type": "string" },
        "pattern_interrupt_question": { "type": "string" }
      }
    },
    "do_not_target": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["reason", "examples"],
        "properties": {
          "reason": { "type": "string" },
          "examples": { "type": "array", "items": { "type": "string" } }
        }
      }
    },
    "target_pack_primary": {
      "type": "array",
      "description": "Leads with fit score >=70",
      "items": { "$ref": "#/definitions/target_lead" }
    },
    "target_pack_secondary": {
      "type": "array",
      "description": "Leads with fit score 60-69",
      "items": { "$ref": "#/definitions/target_lead" }
    },
    "shadow_ops_insights": {
      "type": "object",
      "required": ["top_signals_found", "common_exception_patterns", "notes"],
      "properties": {
        "top_signals_found": { "type": "array", "items": { "type": "string" } },
        "common_exception_patterns": { "type": "array", "items": { "type": "string" } },
        "notes": { "type": "string" }
      }
    }
  },
  "definitions": {
    "target_lead": {
      "type": "object",
      "required": [
        "lead_id",
        "name",
        "company",
        "role",
        "segment",
        "fit_score_0_100",
        "fit_score_breakdown",
        "confidence_level",
        "pain_categories",
        "shadow_ops_density_0_10",
        "shadow_ops_rationale",
        "exception_hypotheses_top3",
        "trigger_event",
        "what_to_say",
        "hooks",
        "pattern_interrupt_question",
        "cta"
      ],
      "properties": {
        "lead_id": { "type": "string" },
        "name": { "type": "string" },
        "company": { "type": "string" },
        "role": { "type": "string" },
        "segment": { "type": "string" },
        "fit_score_0_100": { "type": "integer", "minimum": 0, "maximum": 100 },
        "fit_score_breakdown": {
          "type": "object",
          "required": ["pain_intensity", "urgency_trigger", "authority", "budget_likelihood", "complexity_fit", "tool_fit", "reachability"],
          "properties": {
            "pain_intensity": { "type": "integer", "minimum": 0, "maximum": 20 },
            "urgency_trigger": { "type": "integer", "minimum": 0, "maximum": 15 },
            "authority": { "type": "integer", "minimum": 0, "maximum": 15 },
            "budget_likelihood": { "type": "integer", "minimum": 0, "maximum": 15 },
            "complexity_fit": { "type": "integer", "minimum": 0, "maximum": 15 },
            "tool_fit": { "type": "integer", "minimum": 0, "maximum": 10 },
            "reachability": { "type": "integer", "minimum": 0, "maximum": 10 }
          }
        },
        "confidence_level": { "type": "string", "enum": ["high", "medium", "low"] },
        "pain_categories": { "type": "array", "items": { "type": "string" }, "minItems": 1, "maxItems": 2 },
        "shadow_ops_density_0_10": { "type": "integer", "minimum": 0, "maximum": 10 },
        "shadow_ops_rationale": { "type": "string" },
        "exception_hypotheses_top3": { "type": "array", "items": { "type": "string" }, "minItems": 1, "maxItems": 3 },
        "trigger_event": { "type": "string" },
        "what_to_say": { "type": "string" },
        "hooks": {
          "type": "object",
          "required": ["primary_hook_140_chars", "backup_hook_140_chars"],
          "properties": {
            "primary_hook_140_chars": { "type": "string" },
            "backup_hook_140_chars": { "type": "string" }
          }
        },
        "pattern_interrupt_question": { "type": "string" },
        "cta": { "type": "string" }
      }
    }
  }
}
